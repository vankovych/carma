<!DOCTYPE html>
<html>
    <head>
        <title>ELEKS Career Map</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="css/style.css">

        <script src="js/libs/d3/d3.js"></script>
        <!--<script src="js/libs/jquery/jquery-2.1.4.min.js"></script>-->

        <script src="js/app/main.js"></script>
    </head>
    <body>
        <p>eleks Career Map</p>
        
        <script>
            'use strict';

            var R = 300,
                    CX = 100,
                    CY = 100,
                    P = Math.PI * 2,
                    ArcLen = P / 20,
                    ArcMargin = P / 400;

            d3.json('data.json', function (error, json) {
                if (error) {
                    return console.warn(error);
                }

                var divisions = json.divisions;

                divisions.forEach(function (d, i) {
                    d.i = i + 1;
                });

                //console.log(data);

                var svg = d3.select('body').append('svg');
                var group = svg.append('g')
                        .attr('transform', 'translate(300, 300)');

                group.append('circle')
                        .attr('cx', CX)
                        .attr('cy', CY)
                        .attr('class', 'circle-main-out')
                        .attr('r', R);

                group.append('circle')
                        .attr('cx', CX)
                        .attr('cy', CY)
                        .attr('class', 'circle-main-in')
                        .attr('r', R - 7);

                // render divisions
                group.selectAll('path.division')
                        .data(divisions).enter()
                        .append('path')
                        .attr('d', arc)
                        .attr('cx', 100)
                        .attr('transform', 'translate(100,100)')
                        .attr('class', 'division')
                        .attr('fill', function (d) {
                            return d.color;
                        })
                        .on('click', move);
            });

            // Arc function
            var arc = d3.svg.arc()
                    .startAngle(function (d) {
                        return ArcLen * d.i;
                    })
                    .endAngle(function (d) {
                        return ArcLen * (d.i + 1) - ArcMargin;
                    })
                    .innerRadius(R - 10)
                    .outerRadius(R + 7);

            function move() {
                var arc1 = d3.svg.arc()
                        .startAngle(function (d) {
                            return ArcLen * 15;
                        })
                        .endAngle(function (d) {
                            return ArcLen * (15 + 1) - ArcMargin;
                        })
                        .innerRadius(R - 10)
                        .outerRadius(R + 7);

                d3.select(this)
                        .transition()
                        .duration(750)
                        .attr("d", arc1);
            }

            function arcTween(a) {
                var i = d3.interpolate(this._current, a);
                this._current = i(0);
                return function (t) {
                    return arc(i(t));
                };
            }
        </script>        
    </body>
</html>
