<!DOCTYPE html>
<html>
    <head>
        <title>eleks Career Map</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="css/vendor/normalize.css">
        <link rel="stylesheet" href="css/style.css">

        <script src="js/libs/d3/d3.js"></script>
        <!--<script src="js/libs/jquery/jquery-2.1.4.min.js"></script>-->

        <script src="js/app/main.js"></script>
    </head>
    <body>
        <div id="container">
            <div class="menu">
                <h3><a href="#">eleks Career map</a></h3>
                <ul>
                    <li><a href="#" class="active">Career opportunities</a></li>
                    <li><a href="#">Discovery positions</a></li>
                </ul>                
            </div>            
            <div id="map">
                <svg></svg>
                <!--<button type="button" id="animate">Animate</button>-->
            </div>
        </div>
        <script>
            'use strict';

            d3.json('data.json', function (error, json) {
                if (error) {
                    return console.warn(error);
                }

                var divisions = json.divisions;

                CM.subdivisions = json.subdivisions;
                CM.positions = json.positions;

                // add additional data        
                for (var i = 0, j = 1; i < divisions.length; i++, j++) {
                    if (j === 11) {
                        j += 2;
                    }
                    divisions[i].i = j;
                    divisions[i].startAngle = CM.ArcLen * j;
                }

                // create custom color scale from predifined colors
                CM.color = d3.scale.ordinal()
                        .domain(divisions.map(function (d) {
                            return d.i;
                        }))
                        .range(json.colors);

                CM.svg = d3.select('#map svg')
                        .attr('width', CM.svgWidth)
                        .attr('height', CM.svgHeight);
                CM.group = CM.svg.append('g')
                        .attr('transform', 'translate(' + CM.svgWidth / 2 + ', ' + CM.svgHeight / 2 + ')');

//                CM.group.append('circle')
//                        .attr('cx', 0)
//                        .attr('cy', 0)
//                        .attr('class', 'circle-main-in')
//                        .attr('r', CM.R - 7);

                // render divisions
                CM.group.selectAll('path.division')
                        .data(divisions).enter()
                        // arc
                        .append('path')
                        .attr('id', function (d) {
                            return d.id;
                        })
                        .attr('d', CM.arc)
                        .attr('cx', 100)
                        .attr('class', 'division')
                        .attr('fill', function (d, i) {
                            return CM.color(d.i);
                        })
                        .on('click', function (d) {
                            expandDivision(d);
                        });

                renderTitles(divisions, 'division-title', 1);
            });

            /*
             * Workflow
             * Hover effects
             * Expand / collapse controls 
             */
        </script>
    </body>
</html>
